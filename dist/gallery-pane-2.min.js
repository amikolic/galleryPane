!function(a,b){"function"==typeof define&&define.amd?define(["jquery","swipejs","scroll-slider"],b):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("swipejs"),require("scroll-slider")):a.GalleryPane=b(jQuery,window.Swipe,window.ScrollSlider)}(this,function(a,b,c){function d(a){return"."+a.replace(/\s/g,".")}function e(b,c){var d="";return a.each(b,function(a,b){d+=c(b,a)}),d}function f(){this.initialize.apply(this,arguments)}var g=0,h=a(window),i=a(window.document);return f.defaults={elementClassName:"gpElement",headerClassName:"gpHeader",closeBtnClassName:"gpCloseBtn",pagesClassName:"gpPages",brandingClassName:"gpBrand",itemsWrapClassName:"gpItems",itemClassName:"gpItem",itemImageClassName:"gpItemImage",toggleThumbsBtnClassName:"gpToggleThumbsBtn",thumbsWrapClassName:"gpThumbs",thumbsScrollerClassName:"gpThumbsScroller",thumbClassName:"gpThumb",thumbsOpenedClassName:"gpThumbsActive",thumbActiveClassName:"gpThumbActive",arrowsClassName:"gpArrows",arrowNextClassName:"gpArrow gpArrowNext",arrowPrevClassName:"gpArrow gpArrowPrev",arrowDisabledClassName:"gpArrowDisabled",brandingText:"Gallery pane",toggleThumbsBtnText:"Toggle thumbs",closeBtnText:"Close gallery",appendTarget:"body",items:[],position:0,continuous:!1,slideSpeed:300,navigateWithKeys:!0,closeOnEscapeKey:!0,afterRender:null,scrollSlider:{arrowWrapClass:"gpScrollSliderArrows",arrowNextClass:"gpScrollSliderArrowNext",arrowPrevClass:"gpScrollSliderArrowPrev",arrowDisabledClass:"gpScrollSliderArrowDisabled",hasArrowsClass:"gpScrollSliderHasArrows",touchClass:"gpScrollSliderTouch"}},a.extend(f.prototype,{initialize:function(b){this.options=a.extend(!0,{},f.defaults,b),this.position=this.options.position,this.ens=".GalleryPane"+ ++g,this.render(),this.loadImage(this.position,!0),this.setupEvents()},render:function(){this.$el=a(this.templates.main(this.options)),this.options.items.length>1&&(this.$arrowsCont=a(this.templates.arrows(this.options)).appendTo(this.$el),this.$arrowNext=this.$arrowsCont.find(d(this.options.arrowNextClassName)),this.$arrowPrev=this.$arrowsCont.find(d(this.options.arrowPrevClassName))),this.$swipeEl=this.$el.find(d(this.options.itemsWrapClassName)),this.$itemImages=this.$el.find(d(this.options.itemImageClassName)),this.$pagination=this.$el.find(d(this.options.pagesClassName)),this.$el.appendTo(this.options.appendTarget),this.swipe=new b(this.$swipeEl.get(0),{startSlide:this.position,speed:this.options.slideSpeed,continuous:!1}),this.updateDom().setImageDimensions(),this.options.afterRender&&this.options.afterRender(this)},setEvent:function(b,c,e,f){var g=this.ens,h=c.replace(/\w\b/g,function(a){return a+g});return b.on(h,e&&d(this.options[e]),a.proxy(f,this)),this},setupEvents:function(){this.setEvent(this.$el,"click","toggleThumbsBtnClassName",this.toggleThumbnails),this.setEvent(this.$el,"click","arrowNextClassName",this.next),this.setEvent(this.$el,"click","arrowPrevClassName",this.prev),this.setEvent(this.$el,"click","closeBtnClassName",this.close),this.setEvent(h,"resize",null,this.setImageDimensions),this.setEvent(this.$el,"click","thumbClassName",function(b){var c=a(b.currentTarget);this.setPosition(this.$thumbs.index(c))}),this.setEvent(i,"keyup",null,function(a){this.options.closeOnEscapeKey&&27===a.keyCode&&this.close(),this.options.navigateWithKeys&&this.options.items.length>1&&((39===a.keyCode||68===a.keyCode)&&this.next(),(37===a.keyCode||65===a.keyCode)&&this.prev())})},normalizePosition:function(a){return a>=this.options.items.length?this.options.continuous?0:this.position:0>a?this.options.continuous?this.options.items.length-1:this.position:a},setImageDimensions:function(){this.$itemImages.css("max-height",this.$swipeEl.height()+"px")},loadImage:function(a,b){var c=this,d=new Image,e=this.normalizePosition(a),f=this.options.items[e].largeImage;return this.$itemImages.eq(e).attr("src",f),b&&(d.onload=function(){c.loadImage(a+1).loadImage(a-1)}),d.src=f,this},setPosition:function(a){var b=this.normalizePosition(a);b!==this.position&&(this.position=b,this.swipe.slide(b),this.updateDom(),this.loadImage(b,!0),this.options.afterPositionChange&&this.options.afterPositionChange(this))},updateDom:function(){return this.thumbsSlider&&(this.thumbsSlider.scrollTo(this.position),this.$thumbs.removeClass(this.options.thumbActiveClassName).eq(this.position).addClass(this.options.thumbActiveClassName)),!this.options.continuous&&this.$arrowsCont&&(this.$arrowNext.toggleClass(this.options.arrowDisabledClassName,this.position===this.options.items.length-1),this.$arrowPrev.toggleClass(this.options.arrowDisabledClassName,0===this.position)),this.$pagination.text(this.position+1+"/"+this.options.items.length),this},next:function(){this.setPosition(this.position+1)},prev:function(){this.setPosition(this.position-1)},toggleThumbnails:function(){this.$el.hasClass(this.options.thumbsOpenedClassName)?this.hideThumbNails():this.showThumbnails()},showThumbnails:function(){this.$el.addClass(this.options.thumbsOpenedClassName),this.thumbsSlider||(this.thumbsSlider=new c(a(this.templates.thumbs(this.options)).appendTo(this.$el),this.options.scrollSlider),this.$thumbs=this.thumbsSlider.$el.find(d(this.options.thumbClassName)),this.$thumbs.eq(this.position).addClass(this.options.thumbActiveClassName)),this.thumbsSlider.scrollTo(this.position)},hideThumbNails:function(){this.$el.removeClass(this.options.thumbsOpenedClassName)},close:function(){h.off(this.ens),i.off(this.ens),this.swipe.kill(),this.$el.remove()},templates:{main:function(a){return'<div class="'+a.elementClassName+'"><div class="'+a.headerClassName+'"><div class="'+a.brandingClassName+'">'+a.brandingText+'</div><p class="'+a.pagesClassName+'"></p><button type="button" title="'+a.toggleThumbsBtnText+'" class="'+a.toggleThumbsBtnClassName+'">'+a.toggleThumbsBtnText+'</button><button type="button" title="'+a.closeBtnText+'" class="'+a.closeBtnClassName+'">'+a.closeBtnText+'</button></div><div class="'+a.itemsWrapClassName+'"><ul>'+e(a.items,function(b){return'<li><div class="'+a.itemClassName+'"><img class="'+a.itemImageClassName+'" data-src="'+b.largeImage+'" alt="'+b.title+'" /></div></li>'})+"</ul></div></div>"},thumbs:function(a){return'<div class="'+a.thumbsWrapClassName+'"><div class="'+a.thumbsScrollerClassName+'"><ul>'+e(a.items,function(b){return'<li><div class="'+a.thumbClassName+'"><img src="'+b.smallImage+'" alt="'+b.title+'" /></div></li>'})+"</ul></div></div>"},arrows:function(a){return'<div class="'+a.arrowsClassName+'"><button type="button" class="'+a.arrowNextClassName+'"></button><button type="button" class="'+a.arrowPrevClassName+'"></button></div>'}}}),f});